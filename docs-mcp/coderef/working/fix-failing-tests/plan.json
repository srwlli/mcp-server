{
  "META_DOCUMENTATION": {
    "feature_name": "fix-failing-tests",
    "schema_version": "1.0.0",
    "version": "1.0.0",
    "status": "complete",
    "generated_by": "Lloyd",
    "has_context": true,
    "has_analysis": true
  },
  "UNIVERSAL_PLANNING_STRUCTURE": {
    "0_preparation": {
      "foundation_docs": ["CLAUDE.md", "README.md"],
      "coding_standards": [],
      "reference_components": [],
      "project_structure": {
        "tests": "tests/",
        "unit_tests": "tests/unit/",
        "generators": "generators/"
      }
    },
    "1_executive_summary": {
      "goal": "Fix all 16 failing tests in the comprehensive test suite to achieve 100% pass rate",
      "description": "Quinn's test suite has 16 failing tests due to path/structure assumptions that don't match the actual implementation. This feature fixes those tests without modifying production code.",
      "scope": "Test files only - no production code changes",
      "estimated_complexity": "Low - test corrections only"
    },
    "2_risk_assessment": {
      "risks": [
        {
          "risk": "Tests may reveal actual bugs in production code",
          "mitigation": "Document findings, fix tests to match current behavior, create separate tickets for bugs"
        },
        {
          "risk": "Changing tests may reduce coverage",
          "mitigation": "Run coverage before and after to verify no decrease"
        }
      ],
      "complexity_score": 3,
      "confidence_level": "High"
    },
    "3_current_state_analysis": {
      "files_to_modify": [
        {"path": "tests/unit/generators/test_foundation_generator.py", "purpose": "Fix 10 template path assumptions"},
        {"path": "tests/unit/generators/test_inventory_generator.py", "purpose": "Fix 3 categorization/unicode issues"},
        {"path": "tests/unit/generators/test_context_expert_generator.py", "purpose": "Fix 2 init/TypeScript issues"},
        {"path": "tests/unit/handlers/test_validate_plan_handler.py", "purpose": "Fix 1 valid plan scoring issue"}
      ],
      "files_to_create": [],
      "dependencies": ["pytest", "pytest-asyncio"]
    },
    "4_key_features": {
      "features": [
        {
          "id": "FIX-FOUNDATION",
          "name": "Fix FoundationGenerator tests",
          "description": "Correct template path and structure assumptions in 10 failing tests"
        },
        {
          "id": "FIX-INVENTORY",
          "name": "Fix InventoryGenerator tests",
          "description": "Correct file categorization and unicode handling in 3 tests"
        },
        {
          "id": "FIX-EXPERT",
          "name": "Fix ContextExpertGenerator tests",
          "description": "Correct init path and TypeScript parsing in 2 tests"
        },
        {
          "id": "FIX-VALIDATE",
          "name": "Fix ValidatePlanHandler test",
          "description": "Correct valid plan scoring expectations in 1 test"
        }
      ]
    },
    "5_task_id_system": {
      "workorder": {
        "id": "WO-FIX-FAILING-TESTS-001",
        "name": "Fix Failing Tests",
        "feature_dir": "coderef/working/fix-failing-tests"
      },
      "tasks": [
        {
          "id": "SETUP-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Run pytest to confirm current failures",
          "file": "tests/",
          "acceptance": "16 failures identified and documented"
        },
        {
          "id": "FOUND-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_read_existing_template - correct template path",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-002",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_get_template_info_readme - correct return structure",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-003",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_get_template_info_returns_dict - correct dict structure",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-004",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_readme_goes_to_project_root - correct output path",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-005",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_my_guide_goes_to_project_root - correct output path",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-006",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_other_docs_go_to_foundation_docs - correct output path",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-007",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_output_path_creates_directory - correct directory creation",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-008",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_get_templates_success_status - correct success return",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-009",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_output_paths_for_all_templates - correct all paths",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "FOUND-010",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_template_reading_performance - correct performance test",
          "file": "tests/unit/generators/test_foundation_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "INV-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_categorize_template_by_directory - correct categorization",
          "file": "tests/unit/generators/test_inventory_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "INV-002",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_save_manifest_validates_before_save - correct validation",
          "file": "tests/unit/generators/test_inventory_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "INV-003",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_unicode_in_file_content - correct unicode handling",
          "file": "tests/unit/generators/test_inventory_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "EXPERT-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_init_with_path - correct initialization",
          "file": "tests/unit/generators/test_context_expert_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "EXPERT-002",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_analyze_code_structure_typescript - correct TS parsing",
          "file": "tests/unit/generators/test_context_expert_generator.py",
          "acceptance": "Test passes"
        },
        {
          "id": "VALID-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Fix test_validate_valid_plan - correct score expectations",
          "file": "tests/unit/handlers/test_validate_plan_handler.py",
          "acceptance": "Test passes"
        },
        {
          "id": "VERIFY-001",
          "workorder_id": "WO-FIX-FAILING-TESTS-001",
          "description": "Run full test suite to verify all fixes",
          "file": "tests/",
          "acceptance": "0 failures, all 666 tests pass"
        }
      ]
    },
    "6_implementation_phases": {
      "phases": [
        {
          "phase": 1,
          "name": "Foundation Generator Fixes",
          "description": "Fix the 10 failing foundation generator tests",
          "tasks": ["SETUP-001", "FOUND-001", "FOUND-002", "FOUND-003", "FOUND-004", "FOUND-005", "FOUND-006", "FOUND-007", "FOUND-008", "FOUND-009", "FOUND-010"],
          "deliverables": ["All 10 foundation tests passing"]
        },
        {
          "phase": 2,
          "name": "Inventory and Expert Fixes",
          "description": "Fix inventory generator and context expert tests",
          "tasks": ["INV-001", "INV-002", "INV-003", "EXPERT-001", "EXPERT-002"],
          "deliverables": ["All 5 inventory/expert tests passing"]
        },
        {
          "phase": 3,
          "name": "Validation and Verification",
          "description": "Fix validate handler and verify full suite",
          "tasks": ["VALID-001", "VERIFY-001"],
          "deliverables": ["All 666 tests passing", "0 failures"]
        }
      ]
    },
    "7_testing_strategy": {
      "approach": "Run pytest after each fix to verify incrementally",
      "commands": [
        "pytest tests/unit/generators/test_foundation_generator.py -v",
        "pytest tests/unit/generators/test_inventory_generator.py -v",
        "pytest tests/unit/generators/test_context_expert_generator.py -v",
        "pytest tests/unit/handlers/test_validate_plan_handler.py -v",
        "pytest tests/ -v"
      ]
    },
    "8_success_criteria": {
      "criteria": [
        "All 16 previously failing tests now pass",
        "Total test suite passes (666 tests, 0 failures)",
        "No production code modified",
        "Test coverage maintained or improved"
      ]
    },
    "9_implementation_checklist": {
      "pre_implementation": [
        "Run pytest to confirm 16 failures",
        "Read each failing test to understand expected vs actual"
      ],
      "implementation": [
        "Fix foundation generator tests (10)",
        "Fix inventory generator tests (3)",
        "Fix context expert tests (2)",
        "Fix validate handler test (1)"
      ],
      "post_implementation": [
        "Run full test suite",
        "Verify 0 failures",
        "Commit changes"
      ]
    }
  }
}
