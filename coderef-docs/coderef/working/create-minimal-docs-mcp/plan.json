{
  "META_DOCUMENTATION": {
    "workorder_id": "WO-CREATE-MINIMAL-DOCS-MCP-001",
    "feature_name": "create-minimal-docs-mcp",
    "version": "1.0.0",
    "schema_version": "1.0.0",
    "status": "approved",
    "created_at": "2025-12-23T20:30:00Z",
    "last_updated": "2025-12-23T20:30:00Z",
    "created_by": "Claude Code",
    "description": "Refactor docs-mcp to contain only 12 documentation-focused tools, removing 21 workflow/planning tools that are now in coderef-workflow MCP. Clean architectural separation of concerns: docs-mcp handles documentation generation, changelog management, standards, and auditing; coderef-workflow handles planning, execution, and multi-agent coordination."
  },
  "UNIVERSAL_PLANNING_STRUCTURE": {
    "0_preparation": {
      "title": "Project Analysis & Preparation",
      "description": "Analyze current docs-mcp structure, identify tools to keep vs remove, and plan minimal implementation",
      "key_findings": [
        "docs-mcp currently has 35 handler functions in tool_handlers.py (~1679 lines)",
        "server.py defines Tool() specifications for all 35 tools (~299 lines)",
        "12 documentation tools must be retained (templates, changelog, standards, audit, quickref, risk assessment)",
        "21 workflow/planning tools must be removed (now in coderef-workflow)",
        "Phase 1 of WO-MCP-DOC-WORKFLOW-REFACTOR-001 created coderef-workflow successfully",
        "Phase 3 updated all slash commands to call coderef_workflow tools",
        "Option C chosen: Create minimal docs-mcp with clean rewrite vs surgical removal"
      ],
      "constraints": [
        "Must maintain 100% backward compatibility for 12 retained tools during transition",
        "No breaking changes to existing MCP tool interfaces",
        "All 12 tools must work identically before/after refactor",
        "Tool signatures, input schemas, and responses unchanged",
        "Filesystem integration (coderef/ directory) must be preserved"
      ],
      "dependencies": [
        "Python 3.10+ with existing dependencies (pathlib, json, typing)",
        "pyproject.toml with existing build/test configuration",
        "Existing test suite covering all 35 tools (to validate 12 after refactor)",
        "Git repository with clean working tree"
      ]
    },
    "1_executive_summary": {
      "title": "Project Overview & Goals",
      "description": "Strategic objective and expected outcomes",
      "goal": "Refactor docs-mcp from 35-tool monolith into focused 12-tool documentation service. Reduce complexity, improve maintainability, and establish clean architectural separation with coderef-workflow (planning/execution) and docs-mcp (documentation generation/management).",
      "primary_objective": "Remove 21 workflow/planning tools from docs-mcp and consolidate remaining 12 documentation tools into clean, maintainable implementation. Achieve zero breaking changes for users.",
      "success_criteria": [
        "All 12 retained tools function identically to original implementation",
        "Existing tests for 12 tools pass without modification",
        "Tool handler count reduced from 35 to 12 (66% reduction)",
        "Tool definitions in server.py reduced from 35 to 12",
        "tool_handlers.py reduced from ~1679 to ~600-700 lines",
        "server.py reduced from ~299 to ~150-180 lines",
        "No breaking changes to any MCP tool interfaces",
        "No changes to tool input schemas or response formats",
        "coderef/ directory structure and functionality preserved",
        "Build and test suite runs successfully with no errors"
      ],
      "expected_outcomes": [
        "Cleaner, more focused docs-mcp codebase",
        "Reduced maintenance burden (fewer tools to update)",
        "Clear separation of concerns (documentation vs workflow)",
        "Better architectural clarity for future developers",
        "Improved discoverability of documentation-focused tools"
      ]
    },
    "2_risk_assessment": {
      "title": "Risk Analysis & Mitigation Strategies",
      "description": "Identify potential risks and mitigation approaches",
      "risk_analysis": [
        {
          "risk": "Accidental removal of required tool logic",
          "severity": "critical",
          "probability": "low",
          "impact": "12 tools become broken, reverting to original implementation required",
          "mitigation": "Extract tools systematically using grep/search for exact handler names, verify each tool before removal, run full test suite after each phase"
        },
        {
          "risk": "Syntax errors in Python files during refactoring",
          "severity": "major",
          "probability": "medium",
          "impact": "Build fails, cannot import modules",
          "mitigation": "Run pyproject.toml 'build' after each file modification, validate Python syntax with 'python -m py_compile', use IDE syntax checking"
        },
        {
          "risk": "Incomplete removal of workflow tool dependencies",
          "severity": "major",
          "probability": "low",
          "impact": "Workflow tools fail when coderef-workflow MCP is not running",
          "mitigation": "Verify ALL references removed from both tool_handlers.py and server.py, grep for orphaned imports/functions"
        },
        {
          "risk": "Git merge conflicts in heavily modified files",
          "severity": "minor",
          "probability": "low",
          "impact": "Manual resolution needed before commit",
          "mitigation": "Create new files rather than modifying existing ones when possible, coordinate with other developers"
        },
        {
          "risk": "Test suite failure for removed tools",
          "severity": "major",
          "probability": "high",
          "impact": "Tests fail for 21 workflow tools that no longer exist",
          "mitigation": "Update test suite to remove tests for 21 workflow tools, keep tests for 12 documentation tools"
        }
      ],
      "go_no_go_decision": "GO - Option C (rewrite minimal docs-mcp) is lower risk than surgical removal and achieves cleaner result"
    },
    "3_current_state_analysis": {
      "title": "Current Implementation State",
      "description": "Detailed analysis of what exists now",
      "current_structure": {
        "tool_handlers.py": {
          "lines_of_code": 1679,
          "handler_functions": 35,
          "tools_to_keep": 12,
          "tools_to_remove": 21,
          "handler_removal_estimate": "~600-700 lines removed (36-42%)"
        },
        "server.py": {
          "lines_of_code": 299,
          "tool_definitions": 35,
          "tools_to_keep": 12,
          "tools_to_remove": 21,
          "tool_definition_removal_estimate": "~120-150 lines removed (40-50%)"
        }
      },
      "tools_to_retain_documentation": {
        "list_templates": "List available POWER framework templates",
        "get_template": "Retrieve specific template content",
        "generate_foundation_docs": "Generate all foundation docs for project",
        "generate_individual_doc": "Generate single doc file (README, API, etc)",
        "get_changelog": "Query changelog with filters",
        "add_changelog_entry": "Add entry to changelog",
        "update_changelog": "Meta-tool: instruct AI to update changelog",
        "generate_quickref_interactive": "Interactive interview for quickref guide",
        "establish_standards": "Extract UI/behavior/UX patterns from codebase",
        "audit_codebase": "Audit codebase for standards compliance",
        "check_consistency": "Quick consistency check on modified files",
        "assess_risk": "AI-powered risk assessment for code changes"
      },
      "tools_to_remove_workflow": {
        "planning_tools": [
          "get_planning_template",
          "analyze_project_for_planning",
          "gather_context",
          "create_plan",
          "validate_implementation_plan",
          "generate_plan_review_report",
          "generate_deliverables_template",
          "generate_handoff_context"
        ],
        "execution_tools": [
          "execute_plan",
          "update_task_status"
        ],
        "agent_coordination_tools": [
          "generate_agent_communication",
          "assign_agent_task",
          "verify_agent_completion",
          "aggregate_agent_deliverables",
          "track_agent_status"
        ],
        "archive_tools": [
          "archive_feature"
        ],
        "admin_tools": [
          "log_workorder",
          "get_workorder_log",
          "update_all_documentation",
          "audit_plans",
          "coderef_foundation_docs",
          "generate_features_inventory"
        ]
      },
      "existing_implementations": {
        "foundation_generator.py": "Generates README, ARCHITECTURE, API, COMPONENTS, SCHEMA from templates",
        "changelog_generator.py": "CRUD operations for CHANGELOG.json with schema validation",
        "standards_generator.py": "Extracts UI/behavior/UX patterns from codebase",
        "audit_generator.py": "Audits codebase for standards compliance",
        "risk_assessment.py": "AI-powered risk assessment across 5 dimensions",
        "error_responses.py": "ErrorResponse factory for consistent error handling",
        "handler_decorators.py": "Decorators for error handling and logging",
        "handler_helpers.py": "Formatting and utility functions",
        "validation.py": "Input validation at MCP boundaries",
        "logger_config.py": "Structured logging configuration",
        "constants.py": "Path and file constants"
      }
    },
    "4_key_features": {
      "title": "Feature Requirements & Specifications",
      "description": "Detailed requirements for minimal docs-mcp",
      "feature_requirements": [
        {
          "category": "Core Functionality",
          "requirements": [
            "All 12 documentation tools must have identical functionality to original",
            "Tool input schemas must not change (backward compatible)",
            "Tool response formats must not change (backward compatible)",
            "Tool descriptions must remain accurate",
            "Error handling must be identical to original"
          ]
        },
        {
          "category": "Code Quality",
          "requirements": [
            "Use existing generators (no refactoring of generator logic)",
            "Use existing error handling patterns (ErrorResponse factory)",
            "Use existing logging infrastructure",
            "Use existing input validation layer",
            "Maintain consistent code style with existing handlers"
          ]
        },
        {
          "category": "Filesystem Integration",
          "requirements": [
            "coderef/ directory structure must be identical",
            "changelog/ directory functionality preserved",
            "foundation-docs/ output directory works identically",
            "standards/ directory operations preserved",
            "audits/ directory for audit reports preserved"
          ]
        },
        {
          "category": "Testing & Validation",
          "requirements": [
            "All 12 tools pass existing unit tests without modification",
            "All 12 tools pass existing integration tests without modification",
            "Performance tests show no regression",
            "Build process succeeds without errors",
            "All security validations remain in place"
          ]
        },
        {
          "category": "Documentation & Deployment",
          "requirements": [
            "Slash commands still work for 12 tools (globally deployed)",
            "CLAUDE.md updated to reflect tool reduction",
            "README.md updated with new tool list",
            "CHANGELOG.md updated with version bump and feature description",
            "Build instructions unchanged"
          ]
        }
      ]
    },
    "5_task_id_system": {
      "title": "Task Identification & Tracking System",
      "description": "System for assigning and tracking task IDs during implementation",
      "task_id_pattern": "PHASE-TASKNUM (e.g., SETUP-001, IMPL-003, TEST-001)",
      "workorder_id": "WO-CREATE-MINIMAL-DOCS-MCP-001",
      "task_categories": {
        "SETUP": "Setup and analysis tasks (SETUP-001 to SETUP-003)",
        "IMPL": "Implementation tasks (IMPL-001 to IMPL-004)",
        "TEST": "Testing and validation tasks (TEST-001 to TEST-002)",
        "DEPLOY": "Deployment and finalization (DEPLOY-001)"
      },
      "task_numbering_scheme": "Sequential within category starting from 001, padded to 3 digits"
    },
    "6_implementation_phases": {
      "title": "Implementation Phases & Workflow",
      "description": "Phased approach to refactoring minimal docs-mcp",
      "phase_1": {
        "id": "phase_1_extraction",
        "title": "Tool Extraction & Analysis",
        "description": "Extract 12 documentation tools from existing codebase, verify they are isolated",
        "tasks": [
          {
            "id": "SETUP-001",
            "description": "Identify and document all 12 tool handler functions in tool_handlers.py",
            "acceptance_criteria": [
              "Created file: documentation/12_handlers_list.txt with all handler names",
              "Documented which generators each handler uses",
              "Identified all imports required for 12 tools"
            ],
            "estimated_effort": "30 minutes"
          },
          {
            "id": "SETUP-002",
            "description": "Identify and document all 12 Tool() definitions in server.py",
            "acceptance_criteria": [
              "Created file: documentation/12_tool_definitions.txt with server.py locations",
              "Verified each Tool definition has matching handler in tool_handlers.py",
              "Identified any additional Tool definitions needed"
            ],
            "estimated_effort": "30 minutes"
          },
          {
            "id": "SETUP-003",
            "description": "Extract dependency list for 12 tools (generators, helpers, utilities)",
            "acceptance_criteria": [
              "Created file: documentation/dependencies.txt",
              "Listed all Python imports required by 12 tools",
              "Identified zero-dependency tools vs tool-with-dependencies"
            ],
            "estimated_effort": "20 minutes"
          }
        ]
      },
      "phase_2": {
        "id": "phase_2_minimal_implementation",
        "title": "Create Minimal Implementation",
        "description": "Create new minimal versions of server.py and tool_handlers.py with only 12 tools",
        "tasks": [
          {
            "id": "IMPL-001",
            "description": "Create new minimal server.py with only 12 Tool() definitions",
            "acceptance_criteria": [
              "New server.py file created with 12 Tool definitions only",
              "All Tool names match original (list_templates, get_template, etc)",
              "All inputSchemas copied exactly from original",
              "File has correct MCP initialization and server setup",
              "Comments explain which 12 tools are retained",
              "Original server.py backed up as server.py.bak"
            ],
            "estimated_effort": "45 minutes"
          },
          {
            "id": "IMPL-002",
            "description": "Create new minimal tool_handlers.py with only 12 handler functions and TOOL_HANDLERS registry",
            "acceptance_criteria": [
              "New tool_handlers.py created with 12 handler functions only",
              "All handler function names match original",
              "All handler function signatures copied exactly",
              "All handler function bodies copied exactly",
              "TOOL_HANDLERS dict contains only 12 entries",
              "All required imports included (generators, error responses, logging, helpers)",
              "File has comments explaining which 12 tools are retained",
              "Original tool_handlers.py backed up as tool_handlers.py.bak"
            ],
            "estimated_effort": "60 minutes"
          },
          {
            "id": "IMPL-003",
            "description": "Remove all workflow tool tests from test suite",
            "acceptance_criteria": [
              "Identified all tests for 21 workflow tools",
              "Removed test functions/methods for: get_planning_template, analyze_project_for_planning, gather_context, create_plan, etc",
              "Kept all tests for 12 documentation tools",
              "Tests for 12 tools unmodified and still pass"
            ],
            "estimated_effort": "30 minutes"
          },
          {
            "id": "IMPL-004",
            "description": "Update build configuration and dependencies in pyproject.toml",
            "acceptance_criteria": [
              "pyproject.toml unchanged (all required dependencies still present for 12 tools)",
              "No breaking changes to package structure",
              "No changes to Python version requirements"
            ],
            "estimated_effort": "15 minutes"
          }
        ]
      },
      "phase_3": {
        "id": "phase_3_testing_validation",
        "title": "Testing & Validation",
        "description": "Comprehensive testing to ensure 12 tools function identically to original",
        "tasks": [
          {
            "id": "TEST-001",
            "description": "Run unit tests for all 12 documentation tools",
            "acceptance_criteria": [
              "All 12 tool unit tests pass without modification",
              "No failing test cases",
              "All test assertions pass",
              "Code coverage for 12 tools remains >= 70%"
            ],
            "estimated_effort": "20 minutes"
          },
          {
            "id": "TEST-002",
            "description": "Build minimal docs-mcp and verify it starts without errors",
            "acceptance_criteria": [
              "Project builds successfully with no errors",
              "No import errors or missing dependencies",
              "MCP server initializes without errors",
              "All 12 tools are discoverable via list_tools()",
              "Tool handlers are properly registered in TOOL_HANDLERS"
            ],
            "estimated_effort": "25 minutes"
          }
        ]
      },
      "phase_4": {
        "id": "phase_4_finalization",
        "title": "Documentation & Finalization",
        "description": "Update documentation and commit changes",
        "tasks": [
          {
            "id": "DEPLOY-001",
            "description": "Update documentation and commit minimal docs-mcp refactor",
            "acceptance_criteria": [
              "CLAUDE.md updated with new 12-tool list",
              "README.md updated with tool reduction",
              "Tool catalog section updated (only 12 tools documented)",
              "Version bumped in CLAUDE.md",
              "CHANGELOG entry added for refactor",
              "Git commit created with descriptive message",
              "All changes pushed to remote"
            ],
            "estimated_effort": "30 minutes"
          }
        ]
      }
    },
    "7_testing_strategy": {
      "title": "Testing & Quality Assurance Plan",
      "description": "Comprehensive testing approach for the refactor",
      "testing_approach": {
        "unit_testing": [
          "Run entire unit test suite for 12 documentation tools",
          "Verify all tests pass without modification",
          "Ensure no new test failures introduced"
        ],
        "integration_testing": [
          "Test each of 12 tools via MCP handler layer",
          "Verify tool input validation still works",
          "Verify error handling matches original",
          "Verify file I/O operations work as expected"
        ],
        "build_testing": [
          "Build project with 'uv build' or equivalent",
          "Verify no import errors or syntax errors",
          "Verify all dependencies resolve correctly",
          "Test MCP server initialization"
        ],
        "behavioral_testing": [
          "Test list_templates returns correct tool list",
          "Test get_template returns valid template content",
          "Test generate_foundation_docs creates files in correct locations",
          "Test changelog operations preserve data integrity",
          "Test standards extraction identifies correct patterns",
          "Test audit operations report violations accurately",
          "Test consistency checking finds modified files"
        ]
      },
      "test_coverage_targets": {
        "documentation_tools": "100% pass rate (no regressions)",
        "error_handling": "All error paths still produce identical responses",
        "security_validations": "All input validation checks still active",
        "filesystem_operations": "All file read/write operations work identically"
      },
      "success_criteria": [
        "All 12 tool unit tests pass (0 failures)",
        "All 12 tool integration tests pass (0 failures)",
        "Build completes without errors or warnings",
        "MCP server starts and lists 12 tools correctly",
        "Manual spot checks confirm 3+ tools work as expected"
      ]
    },
    "8_success_criteria": {
      "title": "Definition of Done & Success Metrics",
      "description": "Measurable criteria for successful completion",
      "functional_criteria": [
        {
          "metric": "Tool Function Parity",
          "target": "All 12 tools function identically to original",
          "measurement": "Spot check 3+ tools by calling via MCP protocol"
        },
        {
          "metric": "Tool Availability",
          "target": "All 12 tools discoverable and callable",
          "measurement": "Verify list_tools() returns exactly 12 tools"
        },
        {
          "metric": "Test Pass Rate",
          "target": "100% of tests for 12 tools pass",
          "measurement": "Run test suite, count passed/failed assertions"
        },
        {
          "metric": "Build Success",
          "target": "Project builds without errors",
          "measurement": "Run build, check exit code = 0"
        }
      ],
      "quality_criteria": [
        {
          "metric": "Code Quality",
          "target": "No syntax errors, no import errors",
          "measurement": "Visual code review + syntax validation"
        },
        {
          "metric": "Completeness",
          "target": "All 21 workflow tools completely removed",
          "measurement": "Grep for workflow tool names in codebase"
        },
        {
          "metric": "Backward Compatibility",
          "target": "Zero breaking changes to tool interfaces",
          "measurement": "Compare input schemas and response formats before/after"
        }
      ],
      "performance_criteria": [
        {
          "metric": "Build Time",
          "target": "< 60 seconds",
          "measurement": "Time 'uv build' command"
        },
        {
          "metric": "Tool Invocation",
          "target": "< 1 second response time per tool",
          "measurement": "Test tool performance with timer"
        }
      ]
    },
    "9_implementation_checklist": {
      "title": "Implementation Checklist & Progress Tracking",
      "description": "Detailed step-by-step checklist for implementation execution",
      "checklist": [
        {
          "phase": "phase_1_extraction",
          "task_id": "SETUP-001",
          "description": "Identify and document all 12 tool handler functions",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_1_extraction",
          "task_id": "SETUP-002",
          "description": "Identify and document all 12 Tool() definitions in server.py",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_1_extraction",
          "task_id": "SETUP-003",
          "description": "Extract dependency list for 12 tools",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_2_minimal_implementation",
          "task_id": "IMPL-001",
          "description": "Create new minimal server.py with 12 Tool definitions",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_2_minimal_implementation",
          "task_id": "IMPL-002",
          "description": "Create new minimal tool_handlers.py with 12 handlers",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_2_minimal_implementation",
          "task_id": "IMPL-003",
          "description": "Remove all workflow tool tests from test suite",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_2_minimal_implementation",
          "task_id": "IMPL-004",
          "description": "Update pyproject.toml if needed",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_3_testing_validation",
          "task_id": "TEST-001",
          "description": "Run unit tests for 12 documentation tools",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_3_testing_validation",
          "task_id": "TEST-002",
          "description": "Build and verify minimal docs-mcp",
          "checkbox": "☐",
          "status": "pending"
        },
        {
          "phase": "phase_4_finalization",
          "task_id": "DEPLOY-001",
          "description": "Update documentation and commit refactor",
          "checkbox": "☐",
          "status": "pending"
        }
      ],
      "progress_summary": {
        "total_tasks": 10,
        "completed": 0,
        "in_progress": 0,
        "pending": 10,
        "blocked": 0,
        "percent_complete": 0
      }
    }
  }
}
