{
  "agent_id": "coderef-packages",
  "project_path": "C:\\Users\\willh\\Desktop\\projects\\coderef-system\\packages",
  "audit_date": "2026-01-04",

  "findings": {
    "schemas": [],

    "validators": [
      {
        "file_path": "cli/src/validator.ts",
        "file_name": "validator.ts",
        "purpose": "Tag validation in files and directories - validates CodeRef2 tags using parseCoderefTag from @coderef/core",
        "used_by": [
          "cli/src/cli.ts",
          "cli/test/e2e/validate.e2e.test.ts",
          "52 files reference validator functions (see grep results)"
        ],
        "should_move": true,
        "notes": "39 LOC. Simple wrapper that validates CodeRef2 tags in source files. Reusable across projects for tag validation. Depends on @coderef/core/parser."
      },
      {
        "file_path": "core/src/validator/validator.ts",
        "file_name": "validator.ts",
        "purpose": "Core CodeRef2 EBNF specification validator - validates type designators, paths, elements, metadata against 21 core types and extended types",
        "used_by": [
          "cli/src/commands/validate.ts",
          "core/src/context/index.ts",
          "Multiple test files and documentation",
          "52 files reference CodeRefValidator class"
        ],
        "should_move": true,
        "notes": "348 LOC. Production-quality EBNF validator with strict mode, metadata validation, and suggestion generation. Core validation logic that should be centralized. Validates against 21 core types (F, D, C, Fn, Cl, M, V, S, T, A, Cfg, H, Ctx, R, Q, I, Doc, Gen, Dep, E, WIP, AST) and 3 extended types (ML, DB, SEC)."
      },
      {
        "file_path": "cli/src/commands/validate.ts",
        "file_name": "validate.ts",
        "purpose": "CLI command for CodeRef2 reference validation - validates reference format, suggests corrections, batch processes files, generates validation reports",
        "used_by": [
          "cli/src/cli.ts (main CLI dispatcher)",
          "cli/test/e2e/validate.e2e.test.ts"
        ],
        "should_move": false,
        "notes": "CLI-specific command implementation. Orchestrates validation but delegates to core/src/validator/validator.ts. Should stay in CLI package as it's a command interface, not reusable validation logic."
      },
      {
        "file_path": "path-validation/src/path-validation.ts",
        "file_name": "path-validation.ts",
        "purpose": "Dedicated path validation service - validates Windows paths (MAX_PATH 260 chars, invalid chars, relative components)",
        "used_by": [
          "path-validation/test/path-validation.test.ts",
          "Standalone @coderef/path-validation package"
        ],
        "should_move": true,
        "notes": "Entire package dedicated to path validation. Validates path length, invalid characters (<>:\"|?*), empty paths, relative components (..). Platform-specific (Windows) but reusable validation logic. Should be consolidated into papertrail as PathValidationService."
      }
    ],

    "standards": [
      {
        "file_path": "coderef/standards/BEHAVIOR-STANDARDS.md",
        "file_name": "BEHAVIOR-STANDARDS.md",
        "purpose": "Documents behavior patterns extracted from codebase (error handling, loading states, form validation)",
        "used_by": [
          "Generated by scripts/enhance-standards.py",
          "No direct references found in codebase (standalone documentation)"
        ],
        "should_move": false,
        "notes": "Auto-generated from .coderef/ data. Contains try-catch patterns, pattern-validation. Currently placeholder content. Project-specific output file, not reusable validation standards."
      },
      {
        "file_path": "coderef/standards/UI-STANDARDS.md",
        "file_name": "UI-STANDARDS.md",
        "purpose": "Documents UI patterns extracted from codebase (colors, buttons, typography)",
        "used_by": [
          "Generated by scripts/enhance-standards.py",
          "No direct references found in codebase"
        ],
        "should_move": false,
        "notes": "Auto-generated placeholder. Currently empty (no patterns detected). Project-specific documentation, not validation standards."
      },
      {
        "file_path": "coderef/standards/UX-PATTERNS.md",
        "file_name": "UX-PATTERNS.md",
        "purpose": "Documents UX flows and interaction patterns (navigation, permissions, accessibility)",
        "used_by": [
          "Generated by scripts/enhance-standards.py",
          "No direct references found in codebase"
        ],
        "should_move": false,
        "notes": "Auto-generated placeholder. Intended to extract routing, auth guards, ARIA attributes. Currently placeholder content. Project-specific output."
      },
      {
        "file_path": "coderef/standards/COMPONENT-INDEX.md",
        "file_name": "COMPONENT-INDEX.md",
        "purpose": "Index of 4 components found in codebase with file locations and export status",
        "used_by": [
          "Generated by scripts/enhance-standards.py",
          "No direct references found in codebase"
        ],
        "should_move": false,
        "notes": "Auto-generated component inventory. Lists 4 components: App, Button, Card, LazyComponent from test files. Project-specific inventory, not validation standards."
      }
    ],

    "qa_tools": [
      {
        "file_path": "cli/src/drift-detector.ts",
        "file_name": "drift-detector.ts",
        "purpose": "Detects drift between CodeRef index and current codebase - finds moved/renamed/deleted/unchanged references using Levenshtein similarity (threshold 0.7)",
        "used_by": [
          "cli/src/cli.ts (drift command)",
          "cli/test/drift-detector.test.ts",
          "52 files reference drift-detector functions"
        ],
        "should_move": true,
        "notes": "487 LOC. Production-quality drift detection with fuzzy matching, fix suggestions, and verbose output. Reusable across projects for reference validation. Uses scanCurrentElements from @coderef/core. Can detect: unchanged, moved, renamed, missing elements."
      },
      {
        "file_path": "core/src/context/breaking-change-detector.ts",
        "file_name": "breaking-change-detector.ts",
        "purpose": "Detects breaking changes between git refs - signature comparison, call site enumeration, confidence scoring, migration hint generation (CR-001: P0 Critical Feature)",
        "used_by": [
          "core/src/context/index.ts",
          "core/src/context/__tests__/breaking-change-detector.test.ts",
          "coderef-rag-mcp/src/tools/breaking-change-handler.ts",
          "52 files reference breaking-change-detector"
        ],
        "should_move": true,
        "notes": "1156 LOC. Critical P0 feature for safe agentic refactoring. Uses TypeScript Compiler API to detect parameter, return type, visibility changes. Integrates with AnalyzerService, GraphBuilder, ImpactSimulator, QueryExecutor. Provides severity levels (low/medium/high/critical) and migration hints. Essential QA tool for preventing runtime breakage."
      },
      {
        "file_path": "scripts/enhance-standards.py",
        "file_name": "enhance-standards.py",
        "purpose": "Generates standards markdown files from .coderef/ scan data (BEHAVIOR-STANDARDS.md, UI-STANDARDS.md, UX-PATTERNS.md, COMPONENT-INDEX.md)",
        "used_by": [
          "Standalone generator script",
          "Generates 4 standards files in coderef/standards/"
        ],
        "should_move": false,
        "notes": "Located in scripts/ (parent directory). Tool for auto-generating documentation from coderef scan outputs. Project-specific tooling, not a reusable QA validator."
      }
    ]
  },

  "summary": {
    "total_files_found": 11,
    "schemas_count": 0,
    "validators_count": 4,
    "standards_count": 4,
    "qa_tools_count": 3,
    "recommended_to_move": 4
  },

  "agent_recommendation": "MOVE 4 FILES TO PAPERTRAIL: (1) core/src/validator/validator.ts (348 LOC CodeRef2 EBNF validator - core validation logic), (2) cli/src/validator.ts (39 LOC tag validator - reusable file scanner), (3) path-validation package (path validation service - Windows-specific but reusable), (4) cli/src/drift-detector.ts (487 LOC drift detector - reference validation), (5) core/src/context/breaking-change-detector.ts (1156 LOC P0 critical breaking change detector - prevents runtime failures). DO NOT MOVE: 4 auto-generated standards docs (project-specific output), 1 CLI command (validate.ts - interface not logic), 1 generator script (enhance-standards.py - project tooling). TOTAL: 2030 LOC of production-quality validation/QA code to consolidate into papertrail."
}
