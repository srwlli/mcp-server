{
  "feature_name": "handoff-automation",
  "workorder_id": "WO-HANDOFF-AUTOMATION-001",
  "description": "Create a /handoff slash command that automatically generates agent context files (claude.md) to enable seamless continuity when one agent passes work to another agent mid-project",
  "goal": "Reduce agent handoff time from 20-30 minutes to 2-3 minutes by automating context capture and ensuring new agents can immediately understand project state, current progress, and next steps",
  "requirements": [
    "Must create claude.md context files for agent-to-agent handoffs",
    "Must capture current progress (what's been completed so far)",
    "Must capture work in progress (what current agent is working on)",
    "Must capture next steps (what needs to be done next)",
    "Must support both full mode (comprehensive) and minimal mode (quick summary)",
    "Must auto-populate from plan.json (project goals, architecture, phase objectives)",
    "Must auto-populate from analysis.json (tech stack, dependencies, file structure)",
    "Must auto-populate from git history (recent changes, progress tracking)",
    "Must handle updates to existing claude.md files without overwriting manual edits",
    "Must save context files to coderef/working/{feature-name}/claude.md",
    "Must provide clear output showing what context was captured and where it was saved"
  ],
  "out_of_scope": [
    "Auto-populating 'Notes from Last Agent' from conversation context (deferred to future phase)",
    "Smart merge conflict handling for existing claude.md updates (deferred to future phase)",
    "Automatic blocker extraction from TODO comments in code (deferred to future phase)",
    "OAuth or authentication for multi-agent coordination (not needed for v1)",
    "Real-time agent status tracking (separate feature)",
    "Agent performance metrics and handoff analytics (future enhancement)"
  ],
  "constraints": [
    "Must integrate with existing docs-mcp tool architecture (server.py, tool_handlers.py pattern)",
    "Must follow existing slash command patterns (.claude/commands/*.md structure)",
    "Must use existing templates/ directory structure for claude.md templates",
    "Must not break existing /create-plan, /analyze-for-planning, /gather-context workflows",
    "Must handle missing plan.json or analysis.json gracefully (work without them if needed)",
    "Must preserve workorder ID tracking for consistency with other tools",
    "File I/O must use pathlib.Path for cross-platform compatibility",
    "Must follow existing error handling patterns (handler_decorators.py @mcp_error_handler)"
  ],
  "use_cases": [
    {
      "scenario": "Agent A completes setup phase and needs to hand off to Agent B",
      "steps": [
        "Agent A runs /handoff",
        "Tool creates claude.md with setup progress, current state, next phase tasks",
        "Agent B reads claude.md and immediately understands where to continue"
      ],
      "expected_outcome": "Agent B can start work within 5 minutes with full context"
    },
    {
      "scenario": "Agent is blocked mid-phase and needs to hand off to another agent",
      "steps": [
        "Current agent runs /handoff --mode minimal",
        "Tool captures WIP tasks, blocker notes, and remaining work",
        "New agent reviews minimal context and unblocks or continues"
      ],
      "expected_outcome": "New agent understands blocker and can decide how to proceed"
    },
    {
      "scenario": "Agent completes implementation and hands off for testing",
      "steps": [
        "Implementation agent runs /handoff",
        "Tool captures completed tasks, files changed, test requirements",
        "Testing agent reads context and knows exactly what to test"
      ],
      "expected_outcome": "Testing agent can create test plan without asking questions"
    }
  ],
  "success_criteria": [
    "Agent handoff time reduced to under 5 minutes (from 20-30 minutes)",
    "100% of handoffs use consistent claude.md template structure",
    "New agent can start work without asking questions about project state",
    "Tool successfully creates claude.md files in coderef/working/{feature}/",
    "Tool auto-populates at least 80% of context fields from available data sources",
    "Zero data loss when updating existing claude.md files",
    "Tool handles missing plan.json or analysis.json without crashing"
  ],
  "technical_notes": [
    "Template should include sections: Project Overview, Current Progress, Work In Progress, Next Steps, Important Decisions, File References",
    "Git history parsing should look for commits matching feature name (case-insensitive)",
    "plan.json parsing should extract task completion status (☐ vs ☑)",
    "Default mode should be 'full' for comprehensive context capture",
    "Tool should timestamp all context file updates",
    "Consider adding --update flag to update existing claude.md vs creating new"
  ]
}
