{
  "feature_name": "phase-3-apis-databases",
  "feature_type": "multi-tool-inventory-phase",
  "description": "Phase 3 of Comprehensive Inventory System: API endpoint discovery and database schema analysis. Delivers two MCP tools: api_inventory (Tool #16) and database_inventory (Tool #17).",
  "goals": [
    "Implement api_inventory tool for REST/GraphQL endpoint discovery",
    "Implement database_inventory tool for schema and migration analysis",
    "Support multiple frameworks (FastAPI, Flask, Express, SQLAlchemy, Django ORM)",
    "Generate structured JSON manifests with comprehensive metadata",
    "Integrate both tools into MCP server with proper handlers",
    "Document both tools in README, API.md, my-guide.md",
    "Create slash commands for quick access",
    "Validate schemas and ensure performance targets (<3s APIs, <5s databases)"
  ],
  "user_requirements": [
    "API endpoint discovery with framework detection",
    "Database schema analysis with ORM detection",
    "Migration file tracking (Alembic, Django)",
    "Documentation coverage analysis for APIs",
    "Relationship mapping for database schemas",
    "JSON schema validation for all outputs",
    "Performance: <3 seconds for 100 endpoints, <5 seconds for 50 tables"
  ],
  "constraints": [
    "Two tools in one phase - higher complexity than Phases 1-2",
    "AST parsing required for accurate framework detection",
    "External dependencies: pyyaml for OpenAPI/Swagger parsing",
    "Must maintain consistency with Phase 1 and 2 patterns",
    "Sequential implementation: api_inventory first, database_inventory second"
  ],
  "success_criteria": [
    "api_inventory detects 3+ frameworks (FastAPI, Flask, Express minimum)",
    "api_inventory extracts REST endpoints with method + path",
    "api_inventory parses OpenAPI/Swagger specs",
    "api_inventory calculates documentation coverage percentage",
    "database_inventory detects 2+ ORMs (SQLAlchemy, Django minimum)",
    "database_inventory parses table schemas with columns + types",
    "database_inventory identifies relationships (foreign keys)",
    "database_inventory tracks migrations (Alembic, Django)",
    "Both tools have JSON schema validation",
    "Both tools meet performance targets",
    "All documentation complete (README, API.md, my-guide.md)",
    "Slash commands created for both tools",
    "Changelog entry for v1.7.0",
    "Git commit + push checkpoint"
  ],
  "technical_approach": {
    "api_inventory": {
      "framework_detection": "Import analysis + decorator patterns",
      "endpoint_extraction": "Framework-specific AST parsers",
      "documentation_parsing": "OpenAPI/Swagger YAML/JSON parsing",
      "output": "coderef/inventory/api.json"
    },
    "database_inventory": {
      "database_detection": "Import analysis for ORMs",
      "schema_parsing": "ORM model AST parsing",
      "migration_tracking": "File scanning + version detection",
      "relationship_mapping": "Foreign key analysis",
      "output": "coderef/inventory/database.json"
    }
  },
  "risks": [
    {
      "risk": "Scope too large (2 tools in one phase)",
      "severity": "high",
      "mitigation": "Sequential implementation, simplify if needed, split to v1.7.0 + v1.7.1 if necessary"
    },
    {
      "risk": "Framework diversity hard to support",
      "severity": "medium",
      "mitigation": "Focus on Python/Node.js frameworks, defer others to future versions"
    },
    {
      "risk": "AST parsing complexity",
      "severity": "medium",
      "mitigation": "Use Python ast module, regex fallbacks, accept 80% accuracy vs 100%"
    },
    {
      "risk": "Migration file format variations",
      "severity": "medium",
      "mitigation": "Support major frameworks only, focus on file detection + counts"
    }
  ],
  "estimated_effort": {
    "total_hours": 22,
    "breakdown": {
      "api_inventory": 12,
      "database_inventory": 10
    },
    "complexity": "high"
  },
  "dependencies": {
    "python_packages": ["pyyaml>=6.0", "sqlparse>=0.4.0"],
    "external_apis": []
  },
  "outputs": [
    "generators/api_generator.py",
    "generators/database_generator.py",
    "coderef/inventory/api-schema.json",
    "coderef/inventory/database-schema.json",
    ".claude/commands/api-inventory.md",
    ".claude/commands/database-inventory.md",
    "Updated: server.py (Tool #16, #17)",
    "Updated: tool_handlers.py (handle_api_inventory, handle_database_inventory)",
    "Updated: constants.py (APIFramework, DatabaseType, ORMFramework enums)",
    "Updated: type_defs.py (APIEndpointDict, DatabaseManifestDict, etc.)",
    "Updated: README.md (tool count 17â†’19, examples)",
    "Updated: coderef/foundation-docs/API.md (Tool #16, #17)",
    "Updated: my-guide.md (tools, slash commands)",
    "Updated: coderef/changelog/CHANGELOG.json (v1.7.0)"
  ],
  "reference_implementations": [
    "Phase 1: inventory_manifest (file inventory pattern)",
    "Phase 2: dependency_inventory (multi-parser pattern, external API integration)",
    "generators/inventory_generator.py (590 lines, categorization + risk scoring)",
    "generators/dependency_generator.py (700 lines, multi-ecosystem parsers)"
  ]
}
