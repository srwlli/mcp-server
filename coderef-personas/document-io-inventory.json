{
  "agent_id": "coderef-personas",
  "workorder_id": "WO-DOC-OUTPUT-AUDIT-001",
  "inputs": [
    {
      "file": "personas/custom/*.json",
      "type": "other",
      "frequency": "often",
      "purpose": "Load custom persona definitions (lloyd, ava, marcus, quinn, taylor)"
    },
    {
      "file": "personas/coderef-personas/*.json",
      "type": "other",
      "frequency": "often",
      "purpose": "Load ecosystem personas (coderef-mcp-lead, agents)"
    },
    {
      "file": "personas/base/*.json",
      "type": "other",
      "frequency": "rarely",
      "purpose": "Load base personas (deprecated directory, mostly empty)"
    },
    {
      "file": "templates/persona_template.txt",
      "type": "other",
      "frequency": "sometimes",
      "purpose": "Template for custom persona system prompt generation"
    },
    {
      "file": ".coderef/patterns.json",
      "type": "coderef_output",
      "frequency": "sometimes",
      "purpose": "Load code patterns for enhanced persona context"
    },
    {
      "file": "coderef/workorder/{feature}/plan.json",
      "type": "workflow_doc",
      "frequency": "often",
      "purpose": "Read plan for Lloyd integration (todo generation, tracking)"
    },
    {
      "file": "CLAUDE.md",
      "type": "foundation_doc",
      "frequency": "rarely",
      "purpose": "Read as context (embedded in persona system prompts)"
    },
    {
      "file": "docs/MCP-ECOSYSTEM-REFERENCE.md",
      "type": "other",
      "frequency": "rarely",
      "purpose": "Ecosystem reference (extracted from Lloyd prompt)"
    },
    {
      "file": "docs/LLOYD-REFERENCE.md",
      "type": "other",
      "frequency": "rarely",
      "purpose": "Lloyd workflow reference (extracted from Lloyd prompt)"
    },
    {
      "file": ".claude/commands/*.md",
      "type": "other",
      "frequency": "sometimes",
      "purpose": "Slash command definitions (read for validation tests)"
    }
  ],
  "outputs": [
    {
      "file": "personas/custom/{name}.json",
      "type": "other",
      "frequency": "sometimes",
      "purpose": "Save newly created custom personas"
    },
    {
      "file": "coderef/workorder/{feature}/plan.json",
      "type": "workflow_doc",
      "frequency": "sometimes",
      "purpose": "Update plan with execution status (track_plan_execution)"
    },
    {
      "file": ".coderef/context.md",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    },
    {
      "file": ".coderef/index.json",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    },
    {
      "file": ".coderef/graph.json",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    },
    {
      "file": ".coderef/reports/*.json",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    },
    {
      "file": ".coderef/diagrams/*.mmd",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    },
    {
      "file": ".coderef/exports/*.json",
      "type": "coderef_output",
      "frequency": "rarely",
      "purpose": "Generated by coderef scan (not by personas MCP server)"
    }
  ],
  "notes": {
    "producer_vs_consumer": "coderef-personas is primarily a CONSUMER of documents, not a PRODUCER. It reads persona definitions and workorder docs but generates minimal output (only custom persona JSON files). The .coderef/ outputs listed are NOT generated by this server - they are produced by external coderef scan commands.",
    "embedded_docs": "Persona system prompts contain EMBEDDED copies of ecosystem documentation (CLAUDE.md, workflow guides, standards) totaling 1000+ lines per persona. These are READ during persona creation but not dynamically loaded at runtime.",
    "lloyd_integration": "Lloyd persona and Phase 1 tools (generate_todo_list, track_plan_execution, execute_plan_interactive) heavily read/write plan.json for workorder orchestration.",
    "pattern_loading": "PersonaManager.load_coderef_patterns() optionally reads .coderef/patterns.json to enrich persona context with project-specific code patterns (opt-in feature).",
    "custom_persona_workflow": "create_custom_persona tool reads templates/persona_template.txt, generates system prompt, and writes to personas/custom/{name}.json. Uses template renderer with {{placeholder}} substitution."
  }
}
