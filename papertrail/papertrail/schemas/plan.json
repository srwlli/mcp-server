{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CodeRef Implementation Plan Schema",
  "description": "UDS schema for plan.json - 10-section implementation plan structure",
  "type": "object",
  "document_type": "plan",
  "required_sections": [
    "META_DOCUMENTATION",
    "0_preparation",
    "1_executive_summary",
    "2_risk_assessment",
    "3_current_state_analysis",
    "4_key_features",
    "5_task_id_system",
    "6_implementation_phases",
    "7_testing_strategy",
    "8_success_criteria",
    "9_implementation_checklist"
  ],
  "optional_sections": [
    "UNIVERSAL_PLANNING_STRUCTURE",
    "QUALITY_CHECKLIST_FOR_PLANS",
    "COMMON_MISTAKES_TO_AVOID",
    "USAGE_INSTRUCTIONS"
  ],
  "required_metadata": {
    "workorder_id": {
      "type": "string",
      "pattern": "^WO-[A-Z0-9]+(-[A-Z0-9]+)+-\\d{3}$",
      "description": "Workorder ID in format WO-{FEATURE}-{CATEGORY}-### (requires at least 2 segments)"
    },
    "feature_name": {
      "type": "string",
      "pattern": "^[a-z0-9_-]+$",
      "description": "Feature name (alphanumeric, hyphens, underscores only)"
    },
    "generated_by": {
      "type": "string",
      "pattern": "^coderef-workflow v.*$",
      "description": "Must be generated by coderef-workflow"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version number"
    },
    "status": {
      "type": "string",
      "enum": ["planning", "in_progress", "completed", "archived"]
    }
  },
  "validation_rules": {
    "critical": [
      "Must have workorder_id in META_DOCUMENTATION",
      "Must have all 10 required sections",
      "Must have at least 1 implementation phase",
      "Must have testing strategy defined",
      "Must have success criteria defined"
    ],
    "warnings": [
      "Should have task_id_system with naming convention",
      "Should have pre-implementation preparation steps",
      "Should have risk assessment with dependencies"
    ]
  }
}
