{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://papertrail/schemas/workflow/execution-log-json-schema.json",
  "title": "Execution Log JSON Schema",
  "description": "Schema for task execution logs generated by coderef-workflow. Tracks task progress for plan.json tasks with workorder traceability.",
  "type": "array",
  "items": {
    "type": "object",
    "required": ["timestamp", "workorder_id", "feature_name", "task_count", "tasks"],
    "properties": {
      "timestamp": {
        "type": "string",
        "format": "date-time",
        "description": "ISO 8601 timestamp when execution log was created"
      },
      "workorder_id": {
        "type": "string",
        "pattern": "^WO-[A-Z0-9]+-[A-Z0-9]+-\\d{3}$",
        "description": "Workorder ID in format WO-{CATEGORY}-{ID}-###"
      },
      "feature_name": {
        "type": "string",
        "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
        "description": "Feature name in kebab-case format"
      },
      "task_count": {
        "type": "integer",
        "minimum": 0,
        "description": "Total number of tasks in this execution log"
      },
      "tasks": {
        "type": "array",
        "minItems": 0,
        "description": "Array of task execution records",
        "items": {
          "type": "object",
          "required": ["content", "activeForm", "status"],
          "properties": {
            "content": {
              "type": "string",
              "minLength": 1,
              "description": "Task description (imperative form)"
            },
            "activeForm": {
              "type": "string",
              "minLength": 1,
              "description": "Task description (present continuous form)"
            },
            "status": {
              "type": "string",
              "enum": ["pending", "in_progress", "completed", "failed", "skipped"],
              "description": "Current task status"
            },
            "started_at": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp when task started"
            },
            "completed_at": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp when task completed"
            },
            "error": {
              "type": "string",
              "description": "Error message if task failed"
            },
            "notes": {
              "type": "string",
              "description": "Additional notes about task execution"
            }
          }
        }
      },
      "status": {
        "type": "string",
        "enum": ["in_progress", "completed", "failed"],
        "description": "Overall execution log status"
      },
      "started_at": {
        "type": "string",
        "format": "date-time",
        "description": "ISO 8601 timestamp when execution started"
      },
      "completed_at": {
        "type": "string",
        "format": "date-time",
        "description": "ISO 8601 timestamp when execution completed"
      }
    }
  }
}
