# Papertrail - Universal Documentation Standards

**Version:** 1.0.0
**Status:** Production (Phase 4 Complete)
**Workorder:** WO-PAPERTRAIL-PYTHON-PACKAGE-001

## Purpose

Papertrail provides Universal Documentation Standards (UDS) for the CodeRef ecosystem with complete workorder traceability, automatic validation, and health tracking.

## Features

- **UDS Headers/Footers** - YAML frontmatter with workorder_id, generated_by, feature_id
- **Schema Validation** - Enforce required sections for 5 CodeRef doc types
- **Health Scoring** - 0-100 score (traceability 40%, completeness 30%, freshness 20%, validation 10%)
- **Template Engine** - Jinja2 with inheritance, conditionals, includes
- **CodeRef Extensions** - Auto-inject from coderef-context, git, workflow
- **coderef-docs Integration** - Automatic UDS injection for all 5 doc types

## Implementation Status

- ✅ **Phase 1**: Core UDS (31/31 tests passing)
- ✅ **Phase 2**: Template Engine (44/44 tests passing)
- ✅ **Phase 3**: coderef-docs integration (6/6 tests passing)
- ✅ **Phase 4**: Gradual rollout (5/5 doc types passing)

**Total:** 86/86 tests passing | Status: Production Ready

## Installation

```bash
# Install in development mode
cd papertrail/
pip install -e .

# Install with dev dependencies
pip install -e .[dev]
```

## Quick Start

```python
from papertrail import UDSHeader, UDSFooter, validate_uds, calculate_health

# Create UDS header
header = UDSHeader(
    workorder_id="WO-AUTH-SYSTEM-001",
    generated_by="coderef-docs v1.2.0",
    feature_id="auth-system",
    timestamp="2025-12-29T10:15:00Z",
    title="Authentication System Architecture",
    version="2.1.0"
)

# Generate YAML frontmatter
yaml_header = header.to_yaml()
print(yaml_header)

# Validate document
doc_content = """
---
workorder_id: WO-AUTH-SYSTEM-001
generated_by: coderef-docs v1.2.0
feature_id: auth-system
timestamp: 2025-12-29T10:15:00Z
---

# Architecture

## Purpose
...
"""

result = validate_uds(doc_content, "architecture")
print(f"Valid: {result.valid}, Score: {result.score}")

# Calculate health score
health = calculate_health(doc_content, "architecture")
print(f"Health Score: {health.score}/100")
print(f"  Traceability: {health.traceability}/40")
print(f"  Completeness: {health.completeness}/30")
print(f"  Freshness: {health.freshness}/20")
print(f"  Validation: {health.validation}/10")
```

## Document Types

Papertrail supports 5 CodeRef-specific document types:

1. **plan** - Implementation plans (plan.json) with 10-section structure
2. **deliverables** - Execution tracking (DELIVERABLES.md) with metrics
3. **architecture** - Architecture docs (ARCHITECTURE.md) following POWER framework
4. **readme** - Project overview (README.md) following POWER framework
5. **api** - API documentation (API.md) following POWER framework

## Integration with coderef-docs (Phase 4)

Papertrail is fully integrated into **coderef-docs** MCP server for automatic UDS injection:

```python
# Enable Papertrail in coderef-docs
export PAPERTRAIL_ENABLED=true

# Generate document with UDS using MCP tool
{
  "tool": "generate_individual_doc",
  "arguments": {
    "project_path": "/path/to/project",
    "template_name": "readme",
    "workorder_id": "WO-FEATURE-001",  # Optional: enables UDS
    "feature_id": "my-feature",        # Optional: defaults to template_name
    "version": "1.0.0"                 # Optional: defaults to 1.0.0
  }
}

# Result: Complete document with UDS headers/footers automatically injected
```

**Supported doc types:** README, ARCHITECTURE, API, SCHEMA, COMPONENTS

**Feature flag:** Set `PAPERTRAIL_ENABLED=false` to use legacy generation (backward compatible)

## Development

```bash
# Run tests
pytest

# Run tests with coverage
pytest --cov=papertrail

# Run Phase 4 integration tests
cd ../coderef-docs
python test_phase4_all_docs.py  # Tests all 5 doc types with UDS

# Format code
black papertrail/

# Type checking
mypy papertrail/
```

## Project Structure

```
papertrail/
├── papertrail/
│   ├── __init__.py           # Public API
│   ├── uds.py                # UDSHeader, UDSFooter classes
│   ├── validator.py          # Schema validation
│   ├── health.py             # Health scoring
│   ├── engine.py             # Template engine (Phase 2)
│   ├── extensions/           # CodeRef extensions (Phase 2)
│   │   ├── coderef_context.py
│   │   ├── git_integration.py
│   │   └── workflow.py
│   └── schemas/              # JSON schemas
│       ├── plan.json
│       ├── deliverables.json
│       ├── architecture.json
│       ├── readme.json
│       └── api.json
├── tests/                    # Unit tests
├── setup.py                  # Package configuration
└── README.md                 # This file
```

## License

MIT License

Copyright © 2025 CodeRef Ecosystem

---
Generated by: Papertrail v1.0.0
Workorder: WO-PAPERTRAIL-PYTHON-PACKAGE-001
Last Updated: 2025-12-29
