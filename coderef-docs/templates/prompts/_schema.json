{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LLM Prompt Template Schema",
  "description": "Schema for structured LLM prompts following communication.json pattern",
  "type": "object",
  "required": ["task", "instruction", "context", "output_schema", "success_criteria"],
  "properties": {
    "task": {
      "type": "string",
      "description": "Task type identifier",
      "enum": ["code-review", "architecture", "security-audit", "implementation", "refactor"]
    },
    "instruction": {
      "type": "string",
      "description": "Single sentence directive for the LLM"
    },
    "context": {
      "type": "object",
      "description": "Context for the task",
      "required": ["input", "focus_areas"],
      "properties": {
        "input": {
          "type": "string",
          "description": "User-provided content to analyze"
        },
        "focus_areas": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Areas to emphasize in analysis"
        }
      }
    },
    "output_schema": {
      "type": "object",
      "description": "Required JSON output structure",
      "required": ["findings", "recommendations", "risks", "metrics", "ranked_actions"],
      "properties": {
        "findings": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["category", "description", "severity"],
            "properties": {
              "category": {"type": "string"},
              "description": {"type": "string"},
              "location": {"type": "string"},
              "severity": {"type": "string", "enum": ["critical", "high", "medium", "low"]}
            }
          }
        },
        "recommendations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "description", "priority", "effort"],
            "properties": {
              "id": {"type": "string"},
              "description": {"type": "string"},
              "priority": {"type": "string", "enum": ["high", "medium", "low"]},
              "effort": {"type": "string", "enum": ["small", "medium", "large"]}
            }
          }
        },
        "risks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["description", "severity", "likelihood"],
            "properties": {
              "description": {"type": "string"},
              "severity": {"type": "string", "enum": ["high", "medium", "low"]},
              "likelihood": {"type": "string", "enum": ["high", "medium", "low"]}
            }
          }
        },
        "metrics": {
          "type": "object",
          "required": ["confidence", "coverage", "top_priorities", "summary_stats"],
          "properties": {
            "confidence": {"type": "integer", "minimum": 0, "maximum": 100},
            "coverage": {"type": "string", "enum": ["comprehensive", "partial", "surface"]},
            "top_priorities": {"type": "array", "items": {"type": "string"}},
            "summary_stats": {
              "type": "object",
              "properties": {
                "critical_count": {"type": "integer"},
                "high_count": {"type": "integer"},
                "medium_count": {"type": "integer"},
                "low_count": {"type": "integer"}
              }
            }
          }
        },
        "ranked_actions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["rank", "action", "reason", "impact"],
            "properties": {
              "rank": {"type": "integer"},
              "action": {"type": "string"},
              "reason": {"type": "string"},
              "impact": {"type": "string", "enum": ["high", "medium", "low"]}
            }
          }
        }
      }
    },
    "success_criteria": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Criteria for successful completion"
    }
  }
}
