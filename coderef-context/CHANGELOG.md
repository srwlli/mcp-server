# Changelog

All notable changes to coderef-context MCP server will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [2.1.2] - 2026-01-22

### Fixed

- **Production Schema Version Fix**: Fixed version string mismatch between production scanner and normalization
  - Production scanner (coderef-dashboard) generates `"version": "2.0.0"` (no "v" prefix)
  - Updated schema_utils.py to handle both `"2.0.0"` and `"v2.0.0"` formats
  - Added production version test cases
  - Verified with real games project (780 elements, GameClient/Tetris/GAMES_REGISTRY)

### Documentation

- **v2.0.0 Established as Production Standard**
  - Updated README.md to establish v2.0.0 as primary format
  - Marked v1.0.0 as legacy (backward compatibility only)
  - Removed all references to deprecated coderef-system CLI
  - Documented production scanner: coderef-dashboard/packages/coderef-core

## [2.1.1] - 2026-01-20

### Fixed

- **Schema Version Support (WO-CONTEXT-SCHEMA-VERSION-001)**: Added backward compatibility for both v1.0.0 (legacy) and v2.0.0 (production) .coderef/ schema formats
  - Created `schema_utils.py` with version detection and normalization functions
  - Updated `CodeRefReader` to automatically normalize data when loading index.json and graph.json
  - Fixed `coderef_complexity` tool to work with v2.0.0 schema (GameClient, Tetris components)
  - Fixed `coderef_query` tool to work with v2.0.0 schema (GAMES_REGISTRY queries)
  - Fixed `coderef_impact` tool to work with v2.0.0 schema
  - Fixed `coderef_patterns` tool to work with v2.0.0 schema
  - Updated `complexity_analyzer.py`, `pattern_analyzer.py`, and `validator.py` to use schema normalization
  - Added comprehensive test suite with 25 tests covering both schema versions
  - Zero breaking changes - all existing v1.0.0 projects continue to work

### Technical Details

Schema detection logic:
- v2.0.0 (Production): Has `"version": "2.0.0"` field with metadata wrapper (generated by coderef-dashboard)
- v1.0.0 (Legacy): Flat array in index.json, nodes as dict in graph.json

All tools automatically detect schema version and normalize data before processing, ensuring consistent behavior across both formats.

## [2.1.0] - 2026-01-13

### Added

- Incremental scan support (10x+ faster for small changes)
- Foundation docs generation tool (auto-generates API/SCHEMA/COMPONENTS.md)
- .coderef/ output validation tool
- Comprehensive quickref.md (15-tool cheat sheet)
- Python scanning workflow documentation

## [2.0.0] - 2026-01-10

### Changed

- **Major refactor**: Replaced CLI subprocess calls with direct .coderef/ file reading
- 117x performance improvement (3ms vs 350ms average)
- Reduced codebase from 1,100 â†’ 450 lines (59% reduction)
- Zero external dependencies (removed Node.js requirement)

### Added

- `CodeRefReader` class for unified file access
- All 12 tools refactored with backward compatibility

## [1.1.0] - 2025-12-27

### Added

- `coderef_tag` tool for adding CodeRef2 tags
- Integration tests with coderef-workflow
- Telemetry tracking for MCP tool calls

## [1.0.0] - 2025-12-23

### Added

- Initial release of coderef-context MCP server
- 12 MCP tools for code intelligence:
  - coderef_scan
  - coderef_query
  - coderef_impact
  - coderef_complexity
  - coderef_patterns
  - coderef_coverage
  - coderef_context
  - coderef_validate
  - coderef_drift
  - coderef_diagram
  - coderef_tag
  - coderef_export
