{
  "agent_id": "papertrail",
  "timestamp": "2026-01-10T12:00:00-05:00",
  "phase": "Phase 1: Inventory",
  "documentation_standards": {
    "system_name": "Universal Documentation Standards (UDS)",
    "version": "1.0.0",
    "purpose": "Enforce complete traceability, consistent structure, and automated validation for all CodeRef ecosystem documentation"
  },
  "schemas": [
    {
      "schema_name": "base-frontmatter-schema.json",
      "category": "base",
      "location": "papertrail/schemas/documentation/",
      "purpose": "Foundation schema required for ALL markdown documents",
      "required_fields": ["agent", "date", "task"],
      "field_details": {
        "agent": {
          "type": "string",
          "description": "Who created/updated the document (person, MCP server, or AI agent)",
          "examples": ["Claude Sonnet 4.5", "coderef-docs v1.2.0", "Taylor", "Ava"]
        },
        "date": {
          "type": "string",
          "pattern": "YYYY-MM-DD",
          "description": "Date of creation or last update",
          "examples": ["2026-01-10", "2025-12-25"]
        },
        "task": {
          "type": "string",
          "enum": ["CREATE", "UPDATE", "REVIEW", "DOCUMENT", "CONSOLIDATE", "MIGRATE", "ARCHIVE"],
          "description": "Type of work performed on the document"
        }
      },
      "optional_fields": ["timestamp"],
      "applies_to": "All markdown files in CodeRef ecosystem"
    },
    {
      "schema_name": "foundation-doc-frontmatter-schema.json",
      "category": "foundation",
      "location": "papertrail/schemas/documentation/",
      "purpose": "Validates foundation docs (README, ARCHITECTURE, API, SCHEMA, COMPONENTS) generated by coderef-docs",
      "extends": "base-frontmatter-schema.json",
      "required_fields": ["workorder_id", "generated_by", "feature_id", "doc_type"],
      "field_details": {
        "workorder_id": {
          "type": "string",
          "pattern": "^WO-[A-Z0-9-]+-\\d{3}$",
          "description": "Workorder ID tracking this documentation",
          "examples": ["WO-UDS-SYSTEM-001", "WO-AUTH-SYSTEM-001"]
        },
        "generated_by": {
          "type": "string",
          "pattern": "^coderef-docs",
          "description": "MCP server that generated this document",
          "examples": ["coderef-docs v1.2.0"]
        },
        "feature_id": {
          "type": "string",
          "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
          "description": "Feature identifier (kebab-case)",
          "examples": ["uds-comprehensive-system", "auth-system"]
        },
        "doc_type": {
          "type": "string",
          "enum": ["readme", "architecture", "api", "schema", "components"],
          "description": "Type of foundation document"
        }
      },
      "optional_fields": ["title", "version", "status"],
      "applies_to": "README.md, ARCHITECTURE.md, API.md, SCHEMA.md, COMPONENTS.md"
    },
    {
      "schema_name": "workorder-doc-frontmatter-schema.json",
      "category": "workorder",
      "location": "papertrail/schemas/documentation/",
      "purpose": "Validates workorder docs generated by coderef-workflow",
      "extends": "base-frontmatter-schema.json",
      "required_fields": ["workorder_id", "generated_by", "feature_id", "doc_type"],
      "field_details": {
        "workorder_id": {
          "type": "string",
          "pattern": "^WO-[A-Z0-9-]+-\\d{3}$",
          "description": "Workorder ID",
          "examples": ["WO-AUTH-SYSTEM-001"]
        },
        "generated_by": {
          "type": "string",
          "pattern": "^coderef-workflow",
          "description": "MCP server that generated this document",
          "examples": ["coderef-workflow v1.1.0"]
        },
        "feature_id": {
          "type": "string",
          "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
          "description": "Feature identifier (kebab-case)",
          "examples": ["auth-system", "api-refactor"]
        },
        "doc_type": {
          "type": "string",
          "enum": ["plan", "deliverables", "context", "analysis", "instructions"],
          "description": "Type of workorder document"
        },
        "status": {
          "type": "string",
          "enum": ["draft", "in_progress", "blocked", "review", "complete", "archived"],
          "description": "Workorder status"
        }
      },
      "optional_fields": ["title", "version", "timestamp"],
      "applies_to": "DELIVERABLES.md, context.json, analysis.json"
    },
    {
      "schema_name": "plan.schema.json",
      "category": "plan",
      "location": "papertrail/schemas/planning/",
      "purpose": "Validates plan.json files (10-section format)",
      "required_top_level": ["META_DOCUMENTATION", "UNIVERSAL_PLANNING_STRUCTURE"],
      "meta_documentation_fields": {
        "required": ["feature_name", "schema_version", "status"],
        "optional": ["version", "generated_by", "generated_at"]
      },
      "planning_structure_sections": [
        "0_preparation",
        "1_executive_summary",
        "2_risk_assessment",
        "3_current_state_analysis",
        "4_key_features",
        "5_task_id_system",
        "6_implementation_phases",
        "7_testing_strategy",
        "8_success_criteria",
        "9_implementation_checklist"
      ],
      "applies_to": "plan.json"
    },
    {
      "schema_name": "communication-schema.json",
      "category": "session",
      "location": "papertrail/schemas/sessions/",
      "purpose": "Validates multi-agent session communication files",
      "required_fields": [
        "workorder_id",
        "feature_name",
        "created",
        "status",
        "description",
        "instructions_file",
        "orchestrator",
        "agents"
      ],
      "field_details": {
        "workorder_id": {
          "type": "string",
          "pattern": "^WO-[A-Z0-9-]+-\\d{3}$",
          "description": "Workorder identifier"
        },
        "feature_name": {
          "type": "string",
          "pattern": "^[a-z0-9-]+$",
          "description": "Session name in kebab-case"
        },
        "status": {
          "type": "string",
          "enum": ["not_started", "in_progress", "complete"],
          "description": "Overall session lifecycle state"
        },
        "orchestrator": {
          "type": "object",
          "required": ["agent_id", "agent_path", "role", "output_file", "status", "notes"]
        },
        "agents": {
          "type": "array",
          "required": ["agent_id", "agent_path", "output_file", "status", "notes"]
        }
      },
      "applies_to": "communication.json"
    },
    {
      "schema_name": "system-doc-frontmatter-schema.json",
      "category": "system",
      "location": "papertrail/schemas/documentation/",
      "purpose": "Validates system documentation (CLAUDE.md, SESSION-INDEX.md)",
      "extends": "base-frontmatter-schema.json",
      "required_fields": ["project", "version", "status"],
      "field_details": {
        "project": {
          "type": "string",
          "description": "Project name"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Semantic version"
        },
        "status": {
          "type": "string",
          "enum": ["Production", "Development", "Deprecated", "Archived"]
        }
      },
      "applies_to": "CLAUDE.md, SESSION-INDEX.md"
    },
    {
      "schema_name": "standards-doc-frontmatter-schema.json",
      "category": "standards",
      "location": "papertrail/schemas/documentation/",
      "purpose": "Validates standards documentation",
      "extends": "base-frontmatter-schema.json",
      "required_fields": ["scope", "version", "enforcement"],
      "field_details": {
        "scope": {
          "type": "string",
          "enum": ["global", "project", "category"],
          "description": "Scope of standards"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Standards version"
        },
        "enforcement": {
          "type": "string",
          "enum": ["required", "recommended", "optional"],
          "description": "Enforcement level"
        }
      },
      "applies_to": "global-documentation-standards.md, *-standards.md"
    }
  ],
  "validators": [
    {
      "validator_name": "FoundationDocValidator",
      "location": "papertrail/validators/foundation.py",
      "schema": "foundation-doc-frontmatter-schema.json",
      "category": "foundation",
      "validates": [
        "README.md",
        "ARCHITECTURE.md",
        "API.md",
        "SCHEMA.md",
        "COMPONENTS.md"
      ],
      "checks": [
        "Base UDS fields (agent, date, task)",
        "Foundation fields (workorder_id, generated_by, feature_id, doc_type)",
        "POWER framework sections (Purpose, Overview, What/Why/When, Examples, References)"
      ],
      "usage_pattern": "FoundationDocValidator().validate_file(Path('README.md'))"
    },
    {
      "validator_name": "WorkorderDocValidator",
      "location": "papertrail/validators/workorder.py",
      "schema": "workorder-doc-frontmatter-schema.json",
      "category": "workorder",
      "validates": [
        "DELIVERABLES.md",
        "context.json",
        "analysis.json"
      ],
      "checks": [
        "Base UDS fields (agent, date, task)",
        "Workorder fields (workorder_id, generated_by, feature_id, doc_type, status)",
        "Workorder sections (Tasks, Status, Dependencies, Testing, Risks)"
      ],
      "usage_pattern": "WorkorderDocValidator().validate_file(Path('DELIVERABLES.md'))"
    },
    {
      "validator_name": "PlanValidator",
      "location": "papertrail/validators/plan.py",
      "schema": "plan.schema.json",
      "category": "plan",
      "validates": [
        "plan.json"
      ],
      "checks": [
        "META_DOCUMENTATION structure",
        "10-section planning structure",
        "Required fields in each section",
        "Workorder ID format validation"
      ],
      "usage_pattern": "PlanValidator().validate_file(Path('plan.json'))"
    },
    {
      "validator_name": "SessionDocValidator",
      "location": "papertrail/validators/session.py",
      "schema": "communication-schema.json",
      "category": "session",
      "validates": [
        "communication.json",
        "instructions.json"
      ],
      "checks": [
        "Workorder ID format",
        "Feature name format (kebab-case)",
        "Status enums",
        "Agent IDs (valid CodeRef ecosystem agents)",
        "File paths (absolute Windows paths)",
        "Orchestrator structure",
        "Agents array structure"
      ],
      "usage_pattern": "SessionDocValidator().validate_file(Path('communication.json'))"
    },
    {
      "validator_name": "SystemDocValidator",
      "location": "papertrail/validators/system.py",
      "schema": "system-doc-frontmatter-schema.json",
      "category": "system",
      "validates": [
        "CLAUDE.md",
        "SESSION-INDEX.md"
      ],
      "checks": [
        "Base UDS fields",
        "System fields (project, version, status)",
        "System sections (Quick Summary, Architecture, File Structure, Design Decisions)"
      ],
      "usage_pattern": "SystemDocValidator().validate_file(Path('CLAUDE.md'))"
    },
    {
      "validator_name": "ValidatorFactory",
      "location": "papertrail/validators/factory.py",
      "purpose": "Auto-detects document type and returns appropriate validator",
      "detection_methods": [
        "Path-based detection (30+ file path patterns)",
        "Frontmatter-based detection (field presence)",
        "Fallback to GeneralMarkdownValidator"
      ],
      "usage_pattern": "ValidatorFactory.get_validator(Path('README.md')).validate_file(Path('README.md'))"
    }
  ],
  "validation_result": {
    "structure": {
      "valid": "bool (True if score >= 90)",
      "errors": "list[ValidationError]",
      "warnings": "list[str]",
      "score": "int (0-100)"
    },
    "validation_error": {
      "severity": "ValidationSeverity (CRITICAL, MAJOR, MINOR, WARNING)",
      "message": "str",
      "field": "Optional[str]"
    }
  },
  "score_calculation": {
    "formula": "score = 100 - 50*CRITICAL - 20*MAJOR - 10*MINOR - 5*WARNING - 2*warnings",
    "floor": "max(0, score)",
    "severity_levels": {
      "CRITICAL": {
        "penalty": -50,
        "examples": ["Missing required field", "Invalid schema structure"]
      },
      "MAJOR": {
        "penalty": -20,
        "examples": ["Invalid enum value", "Format violation"]
      },
      "MINOR": {
        "penalty": -10,
        "examples": ["Recommended field missing"]
      },
      "WARNING": {
        "penalty": -5,
        "examples": ["Minor style issue", "Missing optional section"]
      }
    },
    "interpretation": {
      "90-100": "Excellent (validation passes)",
      "70-89": "Good (minor issues)",
      "50-69": "Fair (multiple issues)",
      "0-49": "Poor (major issues)"
    }
  },
  "integration_patterns": {
    "python_import": "from papertrail.validators.factory import ValidatorFactory",
    "validate_single_file": {
      "code": "validator = ValidatorFactory.get_validator(file_path)\nresult = validator.validate_file(file_path)\nif not result.valid:\n    print(f'Validation failed with score {result.score}/100')\n    for error in result.errors:\n        print(f'  - [{error.severity.value}] {error.message}')"
    },
    "validate_specific_validator": {
      "code": "from papertrail.validators.foundation import FoundationDocValidator\nvalidator = FoundationDocValidator()\nresult = validator.validate_file(Path('README.md'))"
    },
    "mcp_tool_usage": {
      "validate_document": {
        "tool_name": "validate_document",
        "input": {
          "file_path": "/absolute/path/to/document.md"
        },
        "output": "Markdown report with score, errors, warnings"
      },
      "check_all_docs": {
        "tool_name": "check_all_docs",
        "input": {
          "directory": "/absolute/path/to/directory",
          "pattern": "**/*.md"
        },
        "output": "Summary with pass/fail counts, average score"
      }
    }
  },
  "recommended_workflow": {
    "for_coderef_docs": [
      "1. Generate foundation doc (README.md, ARCHITECTURE.md, etc.)",
      "2. Call FoundationDocValidator.validate_file(doc_path)",
      "3. If result.valid is False, log errors and optionally fail generation",
      "4. If result.valid is True, log score and proceed"
    ],
    "for_coderef_workflow": [
      "1. Generate workorder doc (DELIVERABLES.md, context.json, plan.json)",
      "2. For plan.json: call PlanValidator.validate_file(plan_path)",
      "3. For DELIVERABLES.md: call WorkorderDocValidator.validate_file(deliverables_path)",
      "4. If result.valid is False, log errors and optionally fail generation",
      "5. If result.valid is True, log score and proceed"
    ]
  },
  "important_notes": [
    "All schemas use JSON Schema Draft-07",
    "All schemas inherit from base-frontmatter-schema.json using allOf pattern",
    "BaseUDSValidator manually merges schemas to avoid network fetch errors",
    "ValidatorFactory automatically detects document type - agents don't need to specify validator manually",
    "Score >= 90 is considered passing (result.valid = True)",
    "Validators can be imported directly or used via ValidatorFactory",
    "MCP tools are available for agent validation: validate_document and check_all_docs"
  ],
  "documentation_resources": [
    "C:\\Users\\willh\\.mcp-servers\\papertrail\\CLAUDE.md - UDS system architecture",
    "C:\\Users\\willh\\.mcp-servers\\papertrail\\docs\\UDS-IMPLEMENTATION-GUIDE.md - Developer guide",
    "C:\\Users\\willh\\.mcp-servers\\papertrail\\WO-UDS-SYSTEM-001-COMPLETION-SUMMARY.md - Workorder completion summary",
    "C:\\Users\\willh\\.mcp-servers\\papertrail\\schemas\\documentation\\ - All JSON schemas",
    "C:\\Users\\willh\\.mcp-servers\\papertrail\\papertrail\\validators\\ - All Python validators"
  ]
}
